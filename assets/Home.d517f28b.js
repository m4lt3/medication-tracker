import{a2 as B,o as V,a4 as v,a5 as C,ar as w,aa as s,c as e,a6 as t,a9 as $,as as L,ac as U,ad as N,x as h,ab as g,at as I,E as T,R as b,au as q,av as F,aw as D,ax as P,ay as R,az as z,aA as G,aB as O,a7 as j}from"./index.c008f4b7.js";import{V as S,a as _}from"./VRow.728c9e3d.js";import{V as E}from"./VSelect.764374fb.js";import{V as J,a as H,b as M}from"./VList.33efd938.js";import{V as W}from"./VForm.94c3fd6c.js";import{_ as K}from"./intakeVisualizer.c6bee035.js";import{V as Q}from"./VContainer.0e6f66d5.js";/* empty css              */import"./VSelectionControl.b676dcd8.js";import"./VChip.563f6689.js";import"./ssrBoot.472001c1.js";import"./deleteModal.554ad063.js";const X={class:"text-h4"},Y={key:0,class:"text-caption"},Z={__name:"limitBar",props:["ingredientInfo","ingredientId"],setup(x){const m=x,n=B(),o=V(()=>p.value/m.ingredientInfo.limit*100),c=V(()=>o.value<80?"success":o.value<100?"warning":"error"),a=V(()=>{let l=[];for(let d in n.intakes){if(!n.pills[n.intakes[d].pill].contents.some(r=>r.ingredient==m.ingredientId?!(n.intakes[d].expired&&n.intakes[d].expired.includes(r.ingredient)):!1))continue;let i={takenAt:n.intakes[d].takenAt},f=n.pills[n.intakes[d].pill].contents.find(r=>r.ingredient==m.ingredientId);i.amount=n.intakes[d].half?f.amount/2:f.amount,l.push(i)}return l.sort((d,y)=>y.takenAt-d.takenAt),l}),p=V(()=>{let l=0;for(let d of a.value)l+=d.amount;return l}),u=V(()=>{if(a.value.length==0)return{at:Date.now(),amount:m.ingredientInfo.limit};let l=a.value[a.value.length-1];return{at:l.takenAt+m.ingredientInfo.expires,amount:l.amount}});return(l,d)=>(v(),C(N,null,[w("p",X,s(m.ingredientInfo.name),1),e(L,{"model-value":o.value,color:c.value,height:"25rem"},{default:t(()=>[$(s(p.value)+" "+s(l.$t("home.of"))+" "+s(m.ingredientInfo.limit)+" mg ",1)]),_:1},8,["model-value","color"]),a.value.length>0?(v(),C("p",Y,"-"+s(u.value.amount)+" mg "+s(l.$t("home.at"))+" "+s(new Date(u.value.at).toLocaleString()),1)):U("",!0)],64))}},ee={__name:"timeModal",emits:["timeSelected"],setup(x,{emit:m}){const n=h(!1),o=h(""),c=h("");function a(){let p=new Date(o.value+"T"+c.value);m("timeSelected",p.valueOf()),n.value=!1,o.value="",c.value=""}return(p,u)=>(v(),g(P,{modelValue:n.value,"onUpdate:modelValue":u[3]||(u[3]=l=>n.value=l),width:"auto"},{activator:t(({props:l})=>[e(I,T(l,{size:"large"}),{default:t(()=>[e(b,{icon:"mdi-clock-edit-outline"})]),_:2},1040)]),default:t(()=>[e(q,{width:"auto"},{title:t(()=>[$(s(p.$t("home.time_modal.title")),1)]),append:t(()=>[e(b,{icon:"mdi-close",onClick:u[0]||(u[0]=l=>n.value=!1)})]),default:t(()=>[e(F,null,{default:t(()=>[w("p",null,s(p.$t("home.time_modal.not_clicking")),1),e(S,null,{default:t(()=>[e(_,{cols:"12",md:"6"},{default:t(()=>[e(D,{"prepend-inner-icon":"mdi-calendar",type:"date",modelValue:o.value,"onUpdate:modelValue":u[1]||(u[1]=l=>o.value=l)},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[e(D,{"prepend-inner-icon":"mdi-clock-outline",type:"time",modelValue:c.value,"onUpdate:modelValue":u[2]||(u[2]=l=>c.value=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[e(I,{block:"",color:"primary",onClick:a},{default:t(()=>[$(s(p.$t("home.time_modal.set_time")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},te={class:"me-2"},le={__name:"intakeForm",emits:["change"],setup(x,{emit:m}){const{t:n}=R(),o=B(),c=V(()=>{let i=[];for(let r in o.pillGroups){i.push({header:o.pillGroups[r].name});let k=0;for(let A in o.pills)o.pills[A].group==r&&(i.push({title:o.pills[A].name,value:Number(A)}),k++);k==0&&i.pop()}let f=0;i.push({header:"Without Group"});for(let r in o.pills)o.pills[r].group==null&&(i.push({title:o.pills[r].name,value:Number(r)}),f++);return f==0&&i.pop(),i}),a=h({pill:null,half:!1}),p={required:i=>i?!0:n("forms.required")},u=h(null),l=h(!1);async function d(){await u.value.validate(),l.value&&(a.value.takenAt||(a.value.takenAt=Date.now()),await o.add("intakes",JSON.parse(JSON.stringify(a.value))),u.value.reset(),a.value.takenAt=void 0)}function y(i){a.value.takenAt=i}return(i,f)=>(v(),g(W,{ref_key:"form",ref:u,modelValue:l.value,"onUpdate:modelValue":f[2]||(f[2]=r=>l.value=r)},{default:t(()=>[e(S,null,{default:t(()=>[e(_,{cols:"12",md:"3"},{default:t(()=>[e(E,{modelValue:a.value.pill,"onUpdate:modelValue":f[0]||(f[0]=r=>a.value.pill=r),items:c.value,rules:[p.required]},{item:t(({props:r,item:k})=>[k.raw.header?(v(),g(J,{key:0},{default:t(()=>[$(s(k.raw.header),1)]),_:2},1024)):k.raw.divider?(v(),g(H,{key:1})):(v(),g(M,z(T({key:2},r)),null,16))]),_:1},8,["modelValue","items","rules"])]),_:1}),e(_,{cols:"12",md:"3",class:"d-flex justify-center"},{default:t(()=>[e(G,{modelValue:a.value.half,"onUpdate:modelValue":f[1]||(f[1]=r=>a.value.half=r),mandatory:"",rules:[p.required]},{default:t(()=>[e(I,{icon:"mdi-circle",value:!1}),e(I,{icon:"mdi-circle-half-full",value:!0})]),_:1},8,["modelValue","rules"])]),_:1}),e(_,{cols:"12",md:"3",class:"d-flex justify-center align-baseline"},{default:t(()=>[w("p",te,s(a.value.takenAt?new Date(a.value.takenAt).toLocaleString():i.$t("home.now")),1),e(ee,{onTimeSelected:y})]),_:1}),e(_,{cols:"12",md:"3"},{default:t(()=>[e(I,{color:"primary",block:"",onClick:d},{default:t(()=>[e(b,{icon:"mdi-plus"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ae={class:"text-h2"},ne={class:"text-h2"},ge={__name:"Home",setup(x){const m=B();return(n,o)=>(v(),g(Q,null,{default:t(()=>[w("h1",ae,s(n.$t("home.current_values")),1),(v(!0),C(N,null,O(j(m).categories,(c,a)=>(v(),g(S,{key:a},{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[e(Z,{ingredientInfo:c,ingredientId:a},null,8,["ingredientInfo","ingredientId"])]),_:2},1024)]),_:2},1024))),128)),w("h1",ne,s(n.$t("home.intakes")),1),e(le),e(K)]),_:1}))}};export{ge as default};
